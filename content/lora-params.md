# LoRa參數設置

# Meshtastic LoRa 配置說明

https://meshtastic.org/docs/overview/radio-settings/

### LoRa 配置選項


LoRa 配置涉及多個參數，包括區域設置、調製預設、最大跳數、發射功率等，這些設置通過發送 Config.LoRa protobuf 的管理消息來調整。

#### 新手常常問的
![IMG_1156](https://hackmd.io/_uploads/HJBHgNAd0.png)

1. Hops（跳數）
Hops 指的是消息在網絡中可以經過的最大中繼節點數量。每當一個消息從一個節點傳送到另一個節點時，這被計為一次「跳」。設定此值可以控制消息在網絡中的傳播範圍，並可影響網絡的擴展性和資源消耗。
**默認值：通常設為 3，這意味著消息可以從原始發送者經由最多兩個中繼節點到達最終接收者。**
用途：增加跳數可以擴大消息的覆蓋範圍，但同時也會增加網絡的擁塞和功耗。

2. Frequency Slot（頻率槽）
Frequency Slot 用於設定節點使用的具體無線頻率。LoRa 通信的頻率範圍依賴於地區配置，並且在一定範圍內分為多個頻率槽。
功能：通過選擇不同的頻率槽，可以減少網絡中的干擾，尤其是在許多節點聚集在同一地區時。
**Meshtastic 中，Frequency Slot 對於台灣地區的默認設定是 16。這意味著，台灣的 Meshtastic 使用者的設備會在預設情況下使用一個特定的無線頻率槽，以保證通信的合法性和效率。**
設定：如果未設定或設為 0（UNSET），節點將使用預設算法基於通道名稱哈希計算其頻率槽。

3. Rx Boosted Gain（接收增強增益）
Rx Boosted Gain 是針對特定型號的 LoRa 晶片（如 SX126x 系列）的選項，允許增強接收器的靈敏度，以改善接收性能。
功效：啟用後，接收增強增益可以在一定程度上提高信號的接收質量，尤其是在信號較弱的環境下。
消耗：增強增益會輕微增加設備的功耗，因此在電池供電的場合需要權衡其利弊。

- 對於 Rx Boosted Gain 的概念，我們可以通過一個簡單的比喻來解釋其作用：
想像你在一個繁忙的市場裡試圖聽清一個遠處朋友的講話。在這種情況下，如果你的耳朵可以「放大」來自那個方向的聲音，那麼即使在嘈雜的背景聲中，你也更有可能聽清楚朋友的話。這就類似於 Rx Boosted Gain 的功能，它允許 LoRa 設備在接收信號時「增強」信號的接收靈敏度，從而改善接收質量，尤其是在信號弱的環境下。
啟用 Rx Boosted Gain 就好比你在人群中使用了一個聽筒，它可以放大遠處的聲音，讓你更清楚地接收信息。這在信號條件不佳時非常有幫助，但可能會消耗更多的電能，就像使用聽筒會需要額外的電力一樣。因此，在使用時需要考慮到設備的電池壽命和操作條件，做出合理的選擇。

#### 重要說明
為了保證設備間的通訊一致性，網絡內的所有設備必須有相同的「區域」和「調製預設」設置，或者是相同的自定義調製設置。

### LoRa 配置值

#### 區域設定
設定您節點的地區。預設未設定。如未設定，節點屏幕將顯示訊息並不會傳送任何數據包。

| Region Code | Description                   | Frequency Range (MHz) | Duty Cycle (%) | Power Limit (dBm) |
|-------------|-------------------------------|-----------------------|----------------|-------------------|
| UNSET       | Unset                         | N/A                   | N/A            | N/A               |
| US          | United States                 | 902.0 - 928.0         | 100            | 30                |
| EU_433      | European Union 433MHz         | 433.0 - 434.0         | 10             | 12                |
| EU_868      | European Union 868MHz         | 869.4 - 869.65        | 10             | 27                |
| CN          | China                         | 470.0 - 510.0         | 100            | 19                |
| JP          | Japan                         | 920.8 - 927.8         | 100            | 16                |
| ANZ         | Australia & New Zealand       | 915.0 - 928.0         | 100            | 30                |
| KR          | Korea                         | 920.0 - 923.0         | 100            |                   |
| TW          | Taiwan                        | 920.0 - 925.0         | 100            | 27                |
| RU          | Russia                        | 868.7 - 869.2         | 100            | 20                |
| IN          | India                         | 865.0 - 867.0         | 100            | 30                |
| NZ_865      | New Zealand 865MHz            | 864.0 - 868.0         | 100            | 36                |
| TH          | Thailand                      | 920.0 - 925.0         | 100            | 16                |
| UA_433      | Ukraine 433MHz                | 433.0 - 434.7         | 10             | 10                |
| UA_868      | Ukraine 868MHz                | 868.0 - 868.6         | 1              | 14                |
| MY_433      | Malaysia 433MHz               | 433.0 - 435.0         | 100            | 20                |
| MY_919      | Malaysia 919MHz               | 919.0 - 924.0         | 100            | 27                |
| SG_923      | Singapore 923MHz              | 917.0 - 925.0         | 100            | 20                |
| LORA_24     | 2.4 GHz band worldwide        | 2400.0 - 2483.5       | 100            | 10                |



#### 調製預設 (Modem Presets)
預設未設定，等同於 LONG_FAST。預設提供了速度與範圍的良好平衡，適合大多數使用者。

Meshtastic提供八種內建的調製預設設定，這些預設會影響傳輸距離、訊息傳送時間以及電池耗電量。調製預設設定控制了LoRa的三個關鍵參數：頻寬(Bandwidth)、擴頻因子(Spread Factor)和編碼率(Coding Rate)。

:::info
:bulb: **新手指南：** 調製預設是決定您的Meshtastic裝置如何傳輸數據的重要設定。選擇哪種預設取決於您的使用場景 - 是需要更遠的傳輸距離還是更快的數據傳輸速度。
:::

##### 調製預設對照表

我們有八種 LoRa 無線電預設值。這些是最常見的設置，已被證明效果良好：

| 無線電預設值 | 替代預設名稱 | 資料傳輸率 | SF / 符號 | 編碼率 | 頻寬 | 鏈路預算 |
| --- | --- | --- | --- | --- | --- | --- |
| 短距離 / 渦輪 | Short Turbo | 21.88 kbps | 7 / 128 | 4/5 | 500 kHz[^1] | 140dB |
| 短距離 / 快速 | Short Fast | 10.94 kbps | 7 / 128 | 4/5 | 250 kHz | 143dB |
| 短距離 / 慢速 | Short Slow | 6.25 kbps | 8 / 256 | 4/5 | 250 kHz | 145.5dB |
| 中距離 / 快速 | Medium Fast | 3.52 kbps | 9 / 512 | 4/5 | 250 kHz | 148dB |
| 中距離 / 慢速 | Medium Slow | 1.95 kbps | 10 / 1024 | 4/5 | 250 kHz | 150.5dB |
| 長距離 / 快速 | Long Fast | 1.07 kbps | 11 / 2048 | 4/5 | 250 kHz | 153dB |
| 長距離 / 適中 | Long Moderate | 0.34 kbps | 11 / 2048 | 4/8 | 125 kHz | 156dB |
| 長距離 / 慢速 | Long Slow | 0.18 kbps | 12 / 4096 | 4/8 | 125 kHz | 158.5dB |

![image](https://hackmd.io/_uploads/B1DR7Yfllx.png)

> 註
> 
> 這些計算使用的鏈路預算假設發射功率為 22dBm 且天線增益為 0dB。請根據您實際的設備調整您的鏈路預算假設。此表中的資料傳輸率是理論上的最大值，但未考慮封包標頭、跳躍和重新傳輸。計算基於官方 [Semtech LoRa 計算器](https://www.semtech.com/design-support/lora-calculator) 的資料。


## 加密

設備使用的預共享金鑰 (PSK) 可以是 AES128 或 AES256 序列。或者，可以關閉加密，這在您持有業餘無線電執照的情況下可能會有用。


##### 如何選擇合適的調製預設？

1. **市區使用或小範圍團隊**：考慮使用 SHORT_FAST 或 MEDIUM_FAST，以獲得更快的消息傳輸速度。
2. **鄉村或開闊地區**：LONG_FAST（預設）或 LONG_SLOW 提供較好的距離覆蓋。
3. **極遠距離需求**：VERY_LONG_SLOW 提供最大範圍，但消息傳輸會較慢。
4. **大型或密集網絡**：雖然 LONG_FAST 是一個很好的通用設置，但對於較大或較密集的網絡可能不是最佳選擇。

:::warning
:zap: **重要提示**：如果您希望您的節點包含/擴展「公共」網格，您必須使用預設調製預設 LONG_FAST。如果更改您的主要通道名稱，您將無法與使用預設設置的其他用戶通信。
:::

#### 最大跳數 hops
設定最大跳數，不得大於 7。預設為 3，適用於大多數應用場景。

#### 發射功率Tx power
如果設為零，則使用預設的最大合法連續功率（即不會損壞無線電硬體的功率）。

#### 啟用發射
允許您啟用或禁用 LoRa 收發器的發射功能。適用於更換天線和其他測試。

#### 忽略 MQTT
設置此選項為 'true' 表示裝置將忽略通過 MQTT 路徑收到的任何消息。此功能需要裝置和 MQTT 節點至少運行固件版本 2.2.19。

#### 更多設置與詳細資料
更詳細的配置選項和使用指南，請訪問 [Meshtastic 官方文件](https://meshtastic.org/docs/hardware/lora-settings)。


## 註腳

[^1]: 短距離/渦輪是最快的預設值，也是唯一一個頻寬為 500kHz 的預設值。由於頻寬較寬，在某些地區使用它可能不合法。

[^2]: Meshtastic QR 碼（或頻道 URL）允許用戶快速共享頻道和 LoRa 設定，使得配置多個具有匹配設定以進行通信的節點變得容易。掃描 QR 碼會應用所有包含的頻道設定和 LoRa 配置設定，因此請確保在繼續之前檢視這些設定包含哪些內容。只掃描來自可信來源的 QR 碼。

   更多詳情，請參見：

   * [頻道配置](/docs/configuration/radio/channels/)
   * [LoRa 配置](/docs/configuration/radio/lora/)